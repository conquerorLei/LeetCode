### 两数相除

#### 题目地址

[29. 两数相除 - 力扣（LeetCode） (leetcode-cn.com)](https://leetcode-cn.com/problems/divide-two-integers/)

#### 解题思路

首先，根据题目，要求我们不能使用除法乘法和取余运算，那么我们可以使用就是加法运算

其次，只有一种越界的情况就是除数为整形最小值，除数为-1，由于整型最大值是比整形最小值小1的，这时候是越界的，这种情况我们特殊判定就好。

> int的范围为$[-2^{31},2^{31} - 1]$

除了上述的判定之外，我们可以做一些其他的特殊判定

- 被除数为0，那么结果就是0
- 除数为1，那么结果就是被除数

> 假设被除数$a$和除数$b$的绝对值分别是$a^{'}, b^{'}$​

以下就是更为一般的情况了。在一般情况下，无论$a$和$b$​两者符号是什么，结果的绝对值一定是$a$和$b$的绝对值相除的结果。由于我们不能使用乘法和除法，所以我们只能使用加法减法，那么我们在加减的时候要尽量避免异号，不然就要不断地取绝对值了。

我们选择全部取为负数，并设置符号位记录原始两数相除的符号位，原始两数符号位相同结果一定是正，否则为负。

> 为什么选择变成负数，因为负数的范围大，尽管仅仅是大一点，那也会避免很多我们不希望的操作

全部取为负数后，我们又可以简化运算，因为如果此时被除数大于除数，也就是$a^{'} < b^{'}$​，进行除法运算之后结果的绝对值一定是小于1的小数，由于题目要求是截去小数部分，那么如果被除数大于除数，此时直接返回0，不需要进行任何运算。

如果$a$​小于等于$b$​，也就是$a^{'} \geq  b^{'}$​​​，此时我们需要做的就是对b进行不断累加逼近a。此时仍然是可以优化的，我们可以每次累加原来累加值的二倍，这样就会减少循环次数。也就是说我们要写一个循环，循环的条件保证$b$的累加值$c$为不能超过整型最小值的一半，因为我们优化后的逻辑的循环体中每次都是对上一次的累加值进行累加的（就相当于加倍了），如果超过了整型的一半，那么就越界了。同样的，我们对于倍数也是累加的，倍数类似$b$的累加值，既然b的累加值加倍了，倍数自然加倍，也得满足不能超过整型最小值的一半。此外，循环的条件还有一个最最重要的，也就是和$a$进行比较。因为累加值$c$是为了不断地逼近$a$，并且每次是乘2的，我们是从右逼近，所以不能让累加值到$a$的左边，所以必须满足
$$
c \geq a - c
$$
至于为什么一定要满足这个条件，首先我们是为了减少循环所以每次累加值c加倍，但是如果最后$a - c$​比$c$大但是仍然比$b$小，就需要继续从$b$开始累加。这也是一个细节。优化之后的细节相对比较多，但是可以接受的。

最后在返回结果的时候，注意符号位，此时运算出来的结果是负数，如果之前计算出来的符号就是负直接返回，如果为正，那么返回相反数。

#### 代码

```java
class Solution {
    private final int MIN = Integer.MIN_VALUE, MAX = Integer.MAX_VALUE, LIMIT = MIN / 2;
    public int divide(int a, int b) {
        // 特殊情况判断
        if(a == MIN && b == -1)return MAX;
        if(a == 0)return 0;
        if(b == 1)return a;
        // 符号位
        boolean flag = false;
        if((a > 0 && b < 0) || (a < 0 && b > 0))flag = true;
        // 转化为负数
        if(a > 0)a = -a;
        if(b > 0)b = -b;
        // 如果a > b,那么说明比值的绝对值是一个小于1的小数，去除小数部分后的结果一定是0
        int res = 0;
        while(a <= b){
            // c为累加值，d为对应的倍数
            int c = b, d = -1;
            // 累加代替乘法
            while(c >= LIMIT && d >= LIMIT && c >= a - c){
                // 如果c<LIMIT，那么c += c就会越界
                c += c;
                d += d;
            }
            a -= c;
            res += d;
        }
        return flag ? res : -res;
    }
}
```

#### 提交记录

![提交记录](https://gitee.com/QingShanxl/pictures/raw/master/img//image-20220109024534554.png)

