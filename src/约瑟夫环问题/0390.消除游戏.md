### 0390.消除游戏

#### 题目地址

[390. 消除游戏 - 力扣（LeetCode） (leetcode-cn.com)](https://leetcode-cn.com/problems/elimination-game/)

#### 解题思路

这道题的思路，在我看过三叶姐的思路过后惊为天人。所以直接参考了三叶姐的题解，这边附上三叶姐的题解的一些说明。

> [【宫水三叶】约瑟夫环运用题 - 消除游戏 - 力扣（LeetCode） (leetcode-cn.com)](https://leetcode-cn.com/problems/elimination-game/solution/gong-shui-san-xie-yue-se-fu-huan-yun-yon-x60m/)

首先是关于公式
$$
f[i] + f^{'}[i] = i + 1
$$
其实，我们可以举个例子。比如i=6的时候，这个时候从左到右和从右到左消除后的序列分别是

```java
2 4 6
5 3 1
```

从右到左消除左边的序列，这一块很容易想到，因为三叶姐的题解借鉴的是约瑟夫环的思想，那么从右向左消除的时候，最后一个消除的是2，并且还是会向作进行遍历知道没有了合适的消除位置位置，也就是-1的位置。也就是说，清楚了2，会接着往左隔一个删除一个，但是隔过去1之后就没有元素了，此时如果按照环的思路，应该就是5了，此时，应该是这一边从右往左删除完了。

如果还是不理解，那就这样想，从右往左消除相当于是将序列逆序再从左向右消除

```java
1 2 3 4 5 6 //从左往右隔一个消除一个
6 5 4 3 2 1 // 也是从左往右，但是实际上是从右向左
```

那个如果i=6，那么$f[i] = 6$、$f^{'}[i] = 1$，很显然，此时满足公式。此时i为偶数，i为奇数也是满足的。

其次，就是后面公式的理解
$$
f[i] = f^{'}[\left \lfloor\frac{i}{2}\right\rfloor] * 2
$$
这个公式，其实是模拟了一个从右向左，紧跟着模拟了一次从左向右。假设此时i = 10

```java
1 2 3 4 5 6 7 8 9 10 // 原序列
2 4 6 8 10 // 从左向右模拟一次隔一个删除一个
4 8 // 从右向左迷你一次隔一个删除一个
```

其实不难发现，第一次模拟后的序列是等差数列，刚好就是$[1, 2, 3, \dots, 10/2] \times 2$，再从右向左模拟一次就是$[2,4]\times 2$，刚好就是$1,2, \dots, 5$​从右向左消除一次然后又乘2​​，也就是推出来了上面的递推公式。

后面就是一个公式的带入，得出来最终的递推公式，直接起飞
$$
f[i] = 2 \times (\left\lfloor\frac{i}{2}\right\rfloor + 1 - f[\left\lfloor\frac{i}{2}\right\rfloor])
$$
递归公式就出来了，然后就是递归边界的判断，若i=1，此时$f[i]=1$

#### 代码

```java
class Solution {
    public int lastRemaining(int n) {
        return n == 1 ? 1 : 2 * (n / 2 + 1 - lastRemaining(n / 2));
    }
}
```

#### 提交记录

![提交记录](https://gitee.com/QingShanxl/pictures/raw/master/img//image-20220103001843972.png)